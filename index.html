<!doctype html>
<html lang="en">
<head>
  <!-- jsPDF for PDF generation -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.2/jspdf.plugin.autotable.min.js"></script>
  
  <!-- Chart.js for profit/loss graph -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Wuroud â€” Admin / Billing</title>
  
  <!-- Google font -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">
  
  <!-- CSS -->
  <link rel="stylesheet" href="style.css">
  
  
  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js"></script>
</head>
<body>

  <header class="site-header">
    <div class="container header-inner">
      <div class="brand">
        <h1>Wuroud <small>(Admin)</small></h1>
        <div class="tag">Footwear â€¢ Fancy â€¢ Toys â€¢ Stationery</div>
      </div>

      <div class="search-area">
        <input id="searchInput" placeholder="Search product name..." />
        <select id="categoryFilter">
          <option value="all">All Categories</option>
        </select>
        <input id="minPrice" placeholder="Min â‚¹" type="number"/>
        <input id="maxPrice" placeholder="Max â‚¹" type="number"/>
        
        <!-- Notification Bell Icon -->
        <div class="notification-bell" id="notificationBell">
          <div class="bell-icon">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M18 8C18 6.4087 17.3679 4.88258 16.2426 3.75736C15.1174 2.63214 13.5913 2 12 2C10.4087 2 8.88258 2.63214 7.75736 3.75736C6.63214 4.88258 6 6.4087 6 8C6 15 3 17 3 17H21C21 17 18 15 18 8Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              <path d="M13.73 21C13.5542 21.3031 13.3019 21.5547 12.9982 21.7295C12.6946 21.9044 12.3504 21.9965 12 21.9965C11.6496 21.9965 11.3054 21.9044 11.0018 21.7295C10.6982 21.5547 10.4458 21.3031 10.27 21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </div>
          <div class="notification-badge" id="notificationBadge">0</div>
        </div>
      </div>
    </div>
    
    <!-- Main Navigation Tabs -->
    <div class="main-navigation">
      <div class="container">
        <nav class="nav-tabs">
          <button id="billingTab" class="nav-tab active" data-section="billing">
            <span class="nav-icon">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M14 2H6C5.46957 2 4.96086 2.21071 4.58579 2.58579C4.21071 2.96086 4 3.46957 4 4V20C4 20.5304 4.21071 21.0391 4.58579 21.4142C4.96086 21.7893 5.46957 22 6 22H18C18.5304 22 19.0391 21.7893 19.4142 21.4142C19.7893 21.0391 20 20.5304 20 20V8L14 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M14 2V8H20" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M16 13H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M16 17H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M10 9H9H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </span>
            <span class="nav-text">Billing</span>
          </button>
          <button id="transactionsTab" class="nav-tab" data-section="transactions">
            <span class="nav-icon">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M3 3V21H21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M9 9L12 6L16 10L22 4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M22 4H18V8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </span>
            <span class="nav-text">Transactions</span>
          </button>
          <button id="stockTab" class="nav-tab" data-section="stock">
            <span class="nav-icon">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M21 16V8C20.9996 7.64928 20.9071 7.30481 20.7315 7.00116C20.556 6.69751 20.3037 6.44536 20 6.27L13 2.27C12.696 2.09446 12.3511 2.00205 12 2.00205C11.6489 2.00205 11.304 2.09446 11 2.27L4 6.27C3.69626 6.44536 3.44398 6.69751 3.26846 7.00116C3.09294 7.30481 3.00036 7.64928 3 8V16C3.00036 16.3507 3.09294 16.6952 3.26846 16.9988C3.44398 17.3025 3.69626 17.5546 4 17.73L11 21.73C11.304 21.9055 11.6489 21.9979 12 21.9979C12.3511 21.9979 12.696 21.9055 13 21.73L20 17.73C20.3037 17.5546 20.556 17.3025 20.7315 16.9988C20.9071 16.6952 20.9996 16.3507 21 16Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M3.27 6.96L12 12.01L20.73 6.96" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M12 22.08V12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </span>
            <span class="nav-text">Stock Details</span>
          </button>
        </nav>
      </div>
    </div>
  </header>
  
  <!-- Notification Panel -->
  <div class="notification-panel" id="notificationPanel">
    <div class="notification-header">
      <h3>Low Stock Alerts</h3>
      <button class="close-btn" id="closeNotificationPanel">&times;</button>
    </div>
    <div class="notification-content" id="notificationContent">
      <div class="no-alerts">No low stock alerts at the moment</div>
    </div>
  </div>
  <div class="notification-overlay" id="notificationOverlay"></div>
  
  <!-- Authentication Forms -->
  <div id="authContainer">
    <div id="loginForm">
      <input type="email" id="email" placeholder="Email" />
      <input type="password" id="password" placeholder="Password" />
      <button id="loginBtn" class="btn primary">Login</button>
      <button id="signUpBtn" class="btn ghost">Sign Up</button>
    </div>
    <button id="logoutBtn" class="btn ghost hidden">Logout</button>
  </div>

  <main class="container">
    <!-- Billing Section -->
    <section id="billingSection" class="main-section active">
      <div class="section-layout">
        <div class="left-col">
      <div class="card add-product">
        <h3>Add New Product</h3>
        <input id="pName" placeholder="Product name" />
        <input id="pPrice" type="number" placeholder="Price (â‚¹)" />
        <input id="pStock" type="number" placeholder="Stock quantity" min="0" />
        <div class="packet-option-row">
          <input type="checkbox" id="isPacketCheckbox" class="packet-checkbox" />
          <label for="isPacketCheckbox" class="packet-label">Packet?</label>
        </div>
        <div id="packetSizeWrap" class="packet-size-wrap" style="display: none;">
          <input id="packetSizeInput" type="number" min="1" placeholder="How many in one packet?" class="packet-size-input" />
        </div>
        <div id="packetPriceWrap" style="display: none;">
          <label for="packetPriceInput">How many â‚¹ for one packet?</label>
          <input id="packetPriceInput" type="number" min="0" placeholder="Packet price (â‚¹)" />
        </div>
        <div id="singlePriceWrap" style="display: none;">
          <label for="singlePriceInput">How many â‚¹ for single?</label>
          <input id="singlePriceInput" type="number" min="0" placeholder="Single price (â‚¹)" />
        </div>
        <div id="singleStockWrap" style="display: none;">
          <label for="singleStockInput">How many single items?</label>
          <input id="singleStockInput" type="number" min="0" placeholder="How many single items?" />
        </div>
        <select id="pCategoryInput" title="Select product category">
          <option value="Footwear">Footwear</option>
          <option value="Fancy">Fancy</option>
          <option value="Toys">Toys</option>
          <option value="Stationery">Stationery</option>
        </select>
        <input id="pImage" placeholder="Image URL (optional)" />
        <button id="addProductBtn" class="btn primary">Add Product</button>
      </div>
          <div id="productGrid" class="grid"></div>
        </div>

        <div class="right-col">
      <div class="card bill-card">
        <h3>Selected Items</h3>
        <input id="custMobile" placeholder="Customer mobile (e.g. 9198XXXXXXXX)" />
        <div id="billTableWrap">
          <table id="billTable" class="bill-table">
            <thead>
              <tr><th>Item</th><th>Qty</th><th>Price</th><th>Sub</th><th></th></tr>
            </thead>
            <tbody></tbody>
            <tfoot>
              <tr><td colspan="3"><strong>Total</strong></td><td id="grandTotal">â‚¹0</td><td></td></tr>
            </tfoot>
          </table>
        </div>
        <div class="bill-actions">
          <button id="generatePdf" class="btn">Generate Bill (PDF)</button>
          <button id="printBtn" class="btn">Print</button>
          <button id="whatsappBtn" class="btn">Send via WhatsApp</button>
          <button id="clearBill" class="btn danger">Clear Cart</button>
        </div>
      </div>

    </section>

    <!-- Transactions Section -->
    <section id="transactionsSection" class="main-section">
      <div class="section-layout">
        <div class="left-col">
          <!-- Transaction History Section -->
          <div class="card transaction-card">
            <div class="transaction-header">
              <h3>ðŸ“‹ Transaction History</h3>
              <div class="transaction-tabs">
                <button id="todayTab" class="tab-btn active">Today</button>
                <button id="monthTab" class="tab-btn">30 Days</button>
              </div>
            </div>
            
            <div id="todayTransactions" class="transaction-content">
              <div class="transaction-summary">
                <span class="summary-label">Today's Total:</span>
                <span id="todayTotal" class="summary-amount">â‚¹0</span>
              </div>
              <div id="todayTransactionsList" class="transaction-list">
                <p class="no-transactions">No transactions today</p>
              </div>
            </div>

            <div id="monthTransactions" class="transaction-content hidden">
              <div class="transaction-summary">
                <span class="summary-label">This Month:</span>
                <span id="monthTotal" class="summary-amount">â‚¹0</span>
              </div>
              <div id="monthTransactionsList" class="transaction-list">
                <!-- Daily summaries will be populated here -->
              </div>
            </div>
          </div>

          <div class="card transaction-overview">
            <h2>ðŸ“Š Transaction Analytics</h2>
            
            <div class="transaction-tabs">
              <button id="todayTransactionTab" class="transaction-tab-btn active">Today</button>
              <button id="monthTransactionTab" class="transaction-tab-btn">30 Days</button>
            </div>
            
            <div id="todayTransactionView" class="transaction-view">
              <div class="transaction-summary">
                <div class="summary-card">
                  <span class="summary-label">Today's Revenue</span>
                  <span id="todayRevenue" class="summary-amount">â‚¹0</span>
                </div>
                <div class="summary-card">
                  <span class="summary-label">Items Sold</span>
                  <span id="todayItemCount" class="summary-count">0</span>
                </div>
              </div>
              <div id="todayTransactionDetails" class="transaction-details">
                <p class="no-data">No transactions today</p>
              </div>
            </div>
            
            <div id="monthTransactionView" class="transaction-view hidden">
              <div class="transaction-summary">
                <div class="summary-card">
                  <span class="summary-label">Monthly Revenue</span>
                  <span id="monthRevenue" class="summary-amount">â‚¹0</span>
                </div>
                <div class="summary-card">
                  <span class="summary-label">Total Items</span>
                  <span id="monthItemCount" class="summary-count">0</span>
                </div>
              </div>
              <div id="monthTransactionDetails" class="transaction-details">
                <p class="no-data">No transactions this month</p>
              </div>
            </div>
          </div>
        </div>
        
        <div class="right-col">
          <div style="display: flex; gap: 20px; align-items: flex-start;">
            <style>
              @media (max-width: 600px) {
                .right-col > div[style*='display: flex'] {
                  flex-direction: column !important;
                  gap: 0 !important;
                  align-items: center !important;
                }
                .performance-card {
                  min-width: 0 !important;
                  margin-bottom: 12px !important;
                }
                .leaderboard-card {
                  min-width: 0 !important;
                  margin-bottom: 12px !important;
                  width: 100% !important;
                  max-width: 350px;
                  margin-left: auto !important;
                  margin-right: auto !important;
                }
                .leaderboard-list {
                  width: 100% !important;
                }
              }
            </style>
            <style>
              @media (max-width: 600px) {
                .right-col > div[style*='display: flex'] {
                  flex-direction: column !important;
                  gap: 0 !important;
                }
                .performance-card {
                  min-width: 0 !important;
                  margin-bottom: 12px !important;
                }
                .leaderboard-card {
                  min-width: 0 !important;
                  margin-bottom: 12px !important;
                }
                .leaderboard-list {
                  width: 100% !important;
                }
              }
            </style>
            <!-- Performance Chart Section -->
            <div class="card performance-card" style="min-width: 340px;">
              <div class="performance-header">
                <h3>Daily Performance</h3>
                <div class="performance-stats">
                  <div class="stat-item">
                    <span class="stat-label">Target:</span>
                    <span class="stat-value target">â‚¹2,000</span>
                  </div>
                  <div class="stat-item">
                    <span class="stat-label">Today:</span>
                    <span id="todayPerformance" class="stat-value today">â‚¹0</span>
                  </div>
                  <div class="stat-item">
                    <span class="stat-label">Status:</span>
                    <span id="performanceStatus" class="stat-value status neutral">On Track</span>
                  </div>
                </div>
              </div>
              <div class="chart-container">
                <canvas id="performanceChart" width="400" height="200"></canvas>
              </div>
              <div class="chart-legend">
                <div class="legend-item">
                  <span class="legend-color profit"></span>
                  <span class="legend-text">Profit (Above â‚¹2,000)</span>
                </div>
                <div class="legend-item">
                  <span class="legend-color loss"></span>
                  <span class="legend-text">Loss (Below â‚¹2,000)</span>
                </div>
                <div class="legend-item">
                  <span class="legend-color target-line"></span>
                  <span class="legend-text">Target Line (â‚¹2,000)</span>
                </div>
              </div>
            </div>

            <div style="display: flex; flex-direction: column; gap: 20px; min-width: 280px;">
              <!-- Weekly Leaderboard -->
              <div class="card leaderboard-card">
                <div class="leaderboard-header" style="display: flex; align-items: center; gap: 8px; margin-bottom: 10px;">
                  <span style="font-size: 22px; color: #222; display: flex; align-items: center;">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <circle cx="12" cy="12" r="10" fill="#222"/>
                      <path d="M12 7L14 13H10L12 7Z" fill="#fff"/>
                      <circle cx="12" cy="16" r="1.5" fill="#fff"/>
                    </svg>
                  </span>
                  <h3 style="margin: 0; font-size: 17px; font-weight: 700; color: #111;">Weekly Top Sold Products</h3>
                </div>
                <div id="weeklyLeaderboard" class="leaderboard-list">
                  <p class="no-data">Loading...</p>
                </div>
              </div>
              <!-- Monthly Leaderboard -->
              <div class="card leaderboard-card">
                <div class="leaderboard-header" style="display: flex; align-items: center; gap: 8px; margin-bottom: 10px;">
                  <span style="font-size: 22px; color: #222; display: flex; align-items: center;">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <rect x="4" y="4" width="16" height="16" rx="8" fill="#222"/>
                      <path d="M12 8V16" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
                      <circle cx="12" cy="18" r="1.5" fill="#fff"/>
                    </svg>
                  </span>
                  <h3 style="margin: 0; font-size: 17px; font-weight: 700; color: #111;">Monthly Top Sold Products</h3>
                </div>
                <div id="monthlyLeaderboard" class="leaderboard-list">
                  <p class="no-data">Loading...</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Stock Details Section -->
    <section id="stockSection" class="main-section">
      <div class="stock-content">
        <div class="card stock-overview">
          <h2>ðŸ“¦ Stock Management</h2>
          
          <div class="stock-stats">
            <div class="stat-card">
              <div class="stat-number" id="totalProducts">0</div>
              <div class="stat-label">Total Products</div>
            </div>
            <div class="stat-card warning">
              <div class="stat-number" id="lowStockCount">0</div>
              <div class="stat-label">Low Stock</div>
            </div>
            <div class="stat-card danger">
              <div class="stat-number" id="outOfStockCount">0</div>
              <div class="stat-label">Out of Stock</div>
            </div>
          </div>
          
          <div class="stock-filters">
            <select id="stockCategoryFilter">
              <option value="all">All Categories</option>
            </select>
            <select id="stockStatusFilter" style="margin-right:18px;">
              <option value="all">All Status</option>
              <option value="low">Low Stock</option>
              <option value="out">Out of Stock</option>
            </select>
            <div class="stock-search-wrap">
              <input id="stockSearchInput" type="text" class="stock-search-input" placeholder="Search stock..." />
            </div>
          </div>
          
          <div class="stock-table-container">
            <table id="stockTable" class="stock-table">
              <thead>
                <tr>
                  <th>Product</th>
                  <th>Category</th>
                  <th>Price</th>
                  <th>Stock</th>
                  <th>Status</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody>
                <!-- Stock data will be populated here -->
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- Professional Notification System -->
  <div id="notification-container" class="notification-container"></div>

  <footer class="footer container">
    <small>Wuroud still in grand atmosphere</small>
  </footer>

  <!-- App logic -->
  <script src="firebase-config.js" type="module"></script>
  <script src="app.js" type="module"></script>

</body>
</html>
